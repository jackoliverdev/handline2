create table public.products (
  id uuid not null default gen_random_uuid (),
  name character varying(255) not null,
  description text null,
  short_description character varying(500) null,
  category character varying(100) not null,
  sub_category character varying(100) null,
  temperature_rating integer null,
  cut_resistance_level character varying(50) null,
  features text[] null,
  applications text[] null,
  industries text[] null,
  image_url character varying(255) null,
  technical_sheet_url character varying(255) null,
  is_featured boolean null default false,
  order_priority integer null default 0,
  created_at timestamp with time zone null default now(),
  updated_at timestamp with time zone null default now(),
  image2_url character varying null,
  image3_url character varying null,
  related_product_id_1 uuid null,
  related_product_id_2 uuid null,
  related_product_id_3 uuid null,
  related_product_id_4 uuid null,
  image4_url character varying null,
  image5_url character varying null,
  out_of_stock boolean not null default false,
  name_locales jsonb null,
  description_locales jsonb null,
  short_description_locales jsonb null,
  category_locales jsonb null,
  sub_category_locales jsonb null,
  features_locales jsonb null,
  applications_locales jsonb null,
  industries_locales jsonb null,
  declaration_sheet_url text null,
  en_standard text null,
  brands text[] not null default array[]::text[],
  tags_locales jsonb not null default '{}'::jsonb,
  size_locales jsonb null,
  length_cm integer null,
  ce_category text null,
  published boolean not null default false,
  coming_soon boolean not null default false,
  availability_status public.product_availability not null default 'in_stock'::product_availability,
  safety jsonb not null default '{}'::jsonb,
  environment_pictograms jsonb not null default '{}'::jsonb,
  technical_sheet_url_it character varying null,
  declaration_sheet_url_it text null,
  manufacturers_instruction_url character varying null,
  manufacturers_instruction_url_it character varying null,
  heat_resistance_level text null,
  materials_locales jsonb null,
  pad_size_json jsonb null,
  declaration_docs_locales jsonb not null default '[]'::jsonb,
  ukca_declaration_url text null,
  protection_class text null,
  npf text null,
  connections text[] null,
  compatible_with text[] null,
  filter_type text null,
  protection_codes text[] null,
  ean text null,
  respiratory_standards jsonb not null default '{}'::jsonb,
  arm_attributes jsonb not null default '{}'::jsonb,
  hearing_standards jsonb not null default '{}'::jsonb,
  hearing_attributes jsonb not null default '{}'::jsonb,
  constraint products_pkey primary key (id),
  constraint products_en_standard_check check (
    (
      en_standard = any (array['EN388'::text, 'EN407'::text])
    )
  )
) TABLESPACE pg_default;

create index IF not exists idx_products_search_gin on public.products using gin (
  to_tsvector(
    'english'::regconfig,
    (
      (
        (
          (
            (COALESCE(name, ''::character varying))::text || ' '::text
          ) || COALESCE(description, ''::text)
        ) || ' '::text
      ) || (
        COALESCE(short_description, ''::character varying)
      )::text
    )
  )
) TABLESPACE pg_default;

create index IF not exists idx_products_trigram on public.products using gin (name gin_trgm_ops, description gin_trgm_ops) TABLESPACE pg_default;

create index IF not exists idx_unified_search_products on public.products using gin (
  to_tsvector(
    'english'::regconfig,
    (
      ((name)::text || ' '::text) || COALESCE(description, ''::text)
    )
  )
) TABLESPACE pg_default;

create index IF not exists products_availability_status_idx on public.products using btree (availability_status) TABLESPACE pg_default;

create index IF not exists products_tags_locales_gin on public.products using gin (tags_locales) TABLESPACE pg_default;

create index IF not exists products_safety_gin on public.products using gin (safety) TABLESPACE pg_default;

create index IF not exists products_env_pictos_gin on public.products using gin (environment_pictograms) TABLESPACE pg_default;

create index IF not exists products_connections_gin on public.products using gin (connections) TABLESPACE pg_default;

create index IF not exists products_compatible_with_gin on public.products using gin (compatible_with) TABLESPACE pg_default;

create index IF not exists products_respiratory_standards_gin on public.products using gin (respiratory_standards) TABLESPACE pg_default;

create index IF not exists products_declaration_docs_gin on public.products using gin (declaration_docs_locales) TABLESPACE pg_default;

create index IF not exists products_arm_attributes_gin on public.products using gin (arm_attributes) TABLESPACE pg_default;

create index IF not exists products_hearing_standards_gin on public.products using gin (hearing_standards) TABLESPACE pg_default;

create index IF not exists products_hearing_attributes_gin on public.products using gin (hearing_attributes) TABLESPACE pg_default;